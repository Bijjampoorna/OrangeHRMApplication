package com.AddEmployeeFunctionality;

import java.io.FileInputStream;
import java.io.FileNotFoundException;
import java.io.IOException;
import java.util.Properties;

import javax.sound.midi.MidiDevice.Info;

import org.apache.log4j.Logger;
import org.apache.log4j.PropertyConfigurator;
import org.apache.poi.ss.usermodel.Cell;
import org.apache.poi.ss.usermodel.Row;
import org.apache.poi.xssf.usermodel.XSSFSheet;
import org.apache.poi.xssf.usermodel.XSSFWorkbook;
import org.openqa.selenium.By;
import org.openqa.selenium.WebElement;
import org.testng.annotations.Test;

import com.BaseTest.BaseTest;

public class Login extends BaseTest
{

	Logger log=Logger.getLogger(Login.class);
	@Test(priority=1)
   public void LoginPageValidation() throws IOException
   {
	   
//LOG4J FILE
	  FileInputStream logFile=new FileInputStream("C:\\Users\\bijja\\Desktop\\OrangeHRMApplication\\OHRMApplicationExcelOperations\\Log4jFile\\OrangeHRMApplication_POM_LogFiles.properties");
	   PropertyConfigurator.configure(logFile);
	   
	   
//PROPERTYFILE	   
	   FileInputStream proFile=new FileInputStream("C:\\Users\\bijja\\Desktop\\OrangeHRMApplication\\OHRMApplicationExcelOperations\\OHRMPropertyFile.properties");
	   Properties pr=new Properties();
	   pr.load(proFile);
	   
//EXCELFILE
	   FileInputStream excelFile=new FileInputStream("C:\\Users\\bijja\\Desktop\\OrangeHRMApplication\\OHRMApplicationExcelOperations\\src\\com\\ExcelWorkBooks\\AddEmployeeTestData.xlsx");
	   
	   XSSFWorkbook workbook=new XSSFWorkbook(excelFile);
	   
	   XSSFSheet sheet=workbook.getSheet("Sheet1");
	   
//GETTING ACTIVE NO. OF ROWS IN THE SHEET
	   
	   int rowCount=sheet.getLastRowNum();
	   System.out.println("The no. of active rows in the sheet is-"+rowCount);
	   log.info("The no. of active rows in the sheet is-"+rowCount);
	   
	   for(int row=1;row<rowCount;row++)
	   {
		   //Getting the rows from sheet
		   
		   Row rowSheet=sheet.getRow(row);
		   
		 //identifying the login panel elements
			By loginpanelElement=By.id(pr.getProperty("LoginPanelElement"));
			WebElement loginPanelL=driver.findElement(loginpanelElement);
			
			
		//getting info from excel
			
			Cell expected_LoginText=rowSheet.getCell(0);
			String expectedLoginText=expected_LoginText.getStringCellValue();
			log.info("The Expected Text of Login Page is-"+expectedLoginText);
			
		   
		   
	   }
	   
	   
	   
   }
	
	
}
