package com.LoginFunctionality;

import java.io.FileInputStream;
import java.io.FileNotFoundException;
import java.io.IOException;
import java.util.Properties;

import org.apache.poi.ss.usermodel.Cell;
import org.apache.poi.ss.usermodel.Row;
import org.apache.poi.xssf.usermodel.XSSFSheet;
import org.apache.poi.xssf.usermodel.XSSFWorkbook;
import org.openqa.selenium.By;
import org.openqa.selenium.WebElement;
import org.testng.annotations.Test;

import com.BaseTest.BaseTest;



public class LoginPageValidation extends BaseTest
{
	public static XSSFWorkbook workbook;
	public static XSSFSheet sheet;
	
	
@Test
	public void loginPage() throws IOException
	{
		
	
		FileInputStream prFile=new FileInputStream("C:\\Users\\bijja\\Desktop\\OrangeHRMApplication\\OHRMApplicationExcelOperations\\OHRMPropertyFile.properties");
		Properties pr=new Properties();
		pr.load(prFile);
		
		
		String loginDataPath="C:\\Users\\bijja\\Desktop\\OrangeHRMApplication\\OHRMApplicationExcelOperations\\ExcelWorkBooks\\LogInTestData.xlsx";
		FileInputStream loginData=new FileInputStream(loginDataPath);
		
//IDENTIFYING WORKBOOK		
		workbook=new XSSFWorkbook(loginData);
		
//VALIDATING LOGIN PANEL 
		
//IDENTIFYINY SHEET
		
		sheet=workbook.getSheet("Sheet1");
		
		int rowsCount=sheet.getLastRowNum();
		System.out.println("The Active Rows In The Sheet Are:-"+rowsCount);
		
		for(int row=1;row<=rowsCount;row++)
		{
			
			//GETTING THE ACTIVE ROWS FROM SHEET
			Row sheetrow=sheet.getRow(row);
			
			By loginpanelElement=By.id(pr.getProperty("LoginPanelElement"));
			WebElement loginPanelL=driver.findElement(loginpanelElement);
			
			Cell expected_LoginText=sheetrow.getCell(0);
			String expectedLoginText=expected_LoginText.getStringCellValue();
			System.out.println("The expected text of Login Text is -"+expectedLoginText);
			
			
			
			
			
		}
		
		
		
		
	}
	
	
	
}
